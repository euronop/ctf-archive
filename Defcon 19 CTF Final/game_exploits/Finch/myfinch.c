
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <assert.h>
#include <unistd.h>
#include <netinet/in.h>
#include <sys/types.h>
#include <sys/socket.h>


char address[] = "dc19:c7f:2011:80::10";
int port = 7777;
int sock;


void SetupConnection(void)
{
  struct sockaddr_in6 addr;

  memset(&addr, 0, sizeof(addr));

  addr.sin6_family = AF_INET6;
  addr.sin6_port   = htons(port);

  assert(inet_pton(AF_INET6, address, &addr.sin6_addr) != 0);

  sock = socket(AF_INET6, SOCK_STREAM, 0);  
  assert(sock != -1);

  assert(connect(sock, (struct sockaddr *)&addr, sizeof(addr)) != -1);
}

void SendCommand(char *cmd)
{
  size_t l = strlen(cmd);
  if(cmd[l-1] != '\n')
    strcat(cmd, "\n");
  send(sock, cmd, strlen(cmd), 0);
}

void GetResponse(void)
{
  char c;
  while( recv(sock, &c, 1, 0) != -1 )
  {
    putchar(c);
  }
}

int main(int argc, char **argv)
{
  char password[] = "q4qQH3GxDe4\n";
  char command[64] = {0};
  unsigned i;
  SetupConnection();

  for(i=1; i < argc; ++i)
  {
    SendCommand(argv[i]);    
  }

  GetResponse();
  close(sock);
  return 0;
}

