#define _CRT_SECURE_NO_WARNINGS

#include <stdio.h>
#include <string.h>

#ifdef _WIN32
    typedef unsigned char    uint8_t;
    typedef unsigned short   uint16_t;
    typedef unsigned int     uint32_t;
#else
    #include <stdint.h>
#endif

uint32_t hash1(char *s)
{
    uint32_t hash = 0;

    while ( *s )
        hash ^= *s++;

    return hash;
}

uint32_t hash2(char *s)
{
    uint32_t hash = 0;

    while ( *s )
        hash = (uint8_t)(2 * hash | (hash >> 7)) ^ *s++;

    return hash;
}

uint32_t hash3(char *s)
{
    uint32_t temp, hash=0;

    while ( *s )
    {
        temp = hash;
        if ( (uint8_t)*s >= hash )
            temp = *s;
        hash = temp;
        ++s;
    }

    return hash;
}

uint32_t hash4(char *s)
{
    uint32_t hash = 0;

    while ( *s )
        hash = 31 * hash + *s++;

    return hash;
}

int main(int argc, char **argv)
{
    printf ("EuroNOP crackme2 (5688865D47F717D51C8E25E6F92B7A50) keygen\n\n");

    if( argc < 2 )
    {
        printf("Usage: crackme2_kg <user>\n");
        return 0;
    }

    printf ("your serial is: %02X%02X%02X%08X\n",
            hash1(argv[1]) ^ 0xFF, hash2(argv[1]) ^ 0xAA,
            hash3(argv[1]) ^ 0x58, hash4(argv[1]) );

    return 0;
}
